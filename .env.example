# =============================================================================
# CONFIGURATION ENVIRONNEMENT - Supply Chain AI Assistant
# =============================================================================
# Copier ce fichier en .env et remplir les valeurs réelles
# IMPORTANT: Ne JAMAIS commiter le fichier .env (contient des secrets)
# =============================================================================

# -----------------------------------------------------------------------------
# APPLICATION SETTINGS
# -----------------------------------------------------------------------------
APP_NAME="Supply Chain AI Assistant"
APP_ENV=development  # development | staging | production
DEBUG=true
LOG_LEVEL=INFO  # DEBUG | INFO | WARNING | ERROR | CRITICAL

# URLs
API_BASE_URL=http://localhost:8000
FRONTEND_URL=http://localhost:3000

# Sécurité
SECRET_KEY=your-secret-key-here-change-in-production  # Générer avec: openssl rand -hex 32
JWT_SECRET_KEY=your-jwt-secret-key-here  # Générer avec: openssl rand -hex 32
JWT_ALGORITHM=HS256
JWT_ACCESS_TOKEN_EXPIRE_MINUTES=30
JWT_REFRESH_TOKEN_EXPIRE_DAYS=7

# CORS (séparer par des virgules)
ALLOWED_ORIGINS=http://localhost:3000,http://localhost:8000

# -----------------------------------------------------------------------------
# LLM APIs (Large Language Models)
# -----------------------------------------------------------------------------
# OpenAI (Embeddings + Chat)
OPENAI_API_KEY=sk-your-openai-api-key-here
OPENAI_MODEL=gpt-4-turbo-preview  # ou gpt-3.5-turbo pour réduire coûts
OPENAI_EMBEDDING_MODEL=text-embedding-3-small  # ou text-embedding-ada-002
OPENAI_TEMPERATURE=0.1  # Faible pour réduire hallucinations
OPENAI_MAX_TOKENS=2000

# Anthropic Claude (Alternative/Backup)
ANTHROPIC_API_KEY=sk-ant-your-anthropic-api-key-here
ANTHROPIC_MODEL=claude-3-sonnet-20240229  # ou claude-3-opus pour meilleure qualité

# Configuration RAG
RAG_CHUNK_SIZE=1000  # Taille des chunks de documents
RAG_CHUNK_OVERLAP=200  # Chevauchement entre chunks
RAG_TOP_K_RESULTS=5  # Nombre de résultats RAG à retourner

# -----------------------------------------------------------------------------
# TYPESENSE (Vector + Keyword Search)
# -----------------------------------------------------------------------------
TYPESENSE_HOST=localhost
TYPESENSE_PORT=8108
TYPESENSE_PROTOCOL=http
TYPESENSE_API_KEY=your-typesense-api-key-here  # Générer un key sécurisé
TYPESENSE_COLLECTION_NAME=supply_chain_documents
TYPESENSE_TTL_SECONDS=86400  # 24 heures = 86400 secondes

# -----------------------------------------------------------------------------
# DATABASE (PostgreSQL)
# -----------------------------------------------------------------------------
# Format: postgresql://user:password@host:port/dbname
DATABASE_URL=postgresql://supplychain_user:your_db_password@localhost:5432/supplychain_db

# Paramètres individuels (alternative au DATABASE_URL)
DB_HOST=localhost
DB_PORT=5432
DB_NAME=supplychain_db
DB_USER=supplychain_user
DB_PASSWORD=your_db_password
DB_POOL_SIZE=10
DB_MAX_OVERFLOW=20

# -----------------------------------------------------------------------------
# REDIS (Cache + Celery Broker)
# -----------------------------------------------------------------------------
REDIS_URL=redis://localhost:6379/0
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_DB=0
REDIS_PASSWORD=  # Laisser vide si pas de mot de passe

# TTL Cache (en secondes)
CACHE_TTL_DEFAULT=3600  # 1 heure
CACHE_TTL_EMBEDDINGS=86400  # 24 heures (cache embeddings)

# -----------------------------------------------------------------------------
# CELERY (Task Queue)
# -----------------------------------------------------------------------------
CELERY_BROKER_URL=redis://localhost:6379/1
CELERY_RESULT_BACKEND=redis://localhost:6379/2
CELERY_TASK_SERIALIZER=json
CELERY_RESULT_SERIALIZER=json
CELERY_ACCEPT_CONTENT=json
CELERY_TIMEZONE=Europe/Paris
CELERY_ENABLE_UTC=true

# -----------------------------------------------------------------------------
# STORAGE (Fichiers temporaires)
# -----------------------------------------------------------------------------
# MinIO (S3-compatible) pour développement local
MINIO_ENDPOINT=localhost:9000
MINIO_ACCESS_KEY=minioadmin
MINIO_SECRET_KEY=minioadmin
MINIO_BUCKET_NAME=supply-chain-uploads
MINIO_USE_SSL=false

# AWS S3 (Production - alternative à MinIO)
# AWS_ACCESS_KEY_ID=your-aws-access-key
# AWS_SECRET_ACCESS_KEY=your-aws-secret-key
# AWS_S3_BUCKET=supply-chain-prod-uploads
# AWS_REGION=eu-west-1

# Stockage local (Développement simple)
LOCAL_STORAGE_PATH=./storage/uploads
FILE_UPLOAD_MAX_SIZE_MB=50  # Taille max fichier en MB
FILE_TTL_HOURS=24  # Purge automatique après 24h

# Formats supportés
ALLOWED_FILE_EXTENSIONS=.xlsx,.xls,.csv,.pdf,.docx,.doc,.pptx,.ppt,.txt

# -----------------------------------------------------------------------------
# EMAIL (Notifications - optionnel MVP)
# -----------------------------------------------------------------------------
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USER=your-email@gmail.com
SMTP_PASSWORD=your-app-specific-password
SMTP_FROM_EMAIL=noreply@supplychain-ai.com
SMTP_FROM_NAME="Supply Chain AI Assistant"
SMTP_USE_TLS=true

# -----------------------------------------------------------------------------
# MONITORING & LOGGING (Production)
# -----------------------------------------------------------------------------
# Sentry (Error tracking)
SENTRY_DSN=  # https://sentry.io DSN

# Prometheus metrics
ENABLE_METRICS=true
METRICS_PORT=9090

# Application Insights / Datadog (optionnel)
# DATADOG_API_KEY=
# APPLICATIONINSIGHTS_CONNECTION_STRING=

# -----------------------------------------------------------------------------
# RATE LIMITING
# -----------------------------------------------------------------------------
RATE_LIMIT_ENABLED=true
RATE_LIMIT_REQUESTS_PER_MINUTE=60
RATE_LIMIT_REQUESTS_PER_HOUR=1000

# -----------------------------------------------------------------------------
# FEATURES FLAGS (MVP vs V1 vs V2)
# -----------------------------------------------------------------------------
FEATURE_EXCEL_SUPPORT=true
FEATURE_PDF_SUPPORT=true
FEATURE_WORD_SUPPORT=true
FEATURE_PPT_SUPPORT=true
FEATURE_CSV_SUPPORT=true

# Phase 1 MVP
FEATURE_CITATIONS=true
FEATURE_ALERT_MODE=true

# Phase 2 V1 (désactivé pour MVP)
FEATURE_EXPORT_REPORTS=false
FEATURE_DUAL_PERSONA=false  # Opérationnel vs Directeur
FEATURE_SCENARIO_COMPARISON=false

# Phase 3 V2 (désactivé pour MVP)
FEATURE_WHAT_IF_SIMULATION=false
FEATURE_MULTI_DOC_ANALYSIS=false

# -----------------------------------------------------------------------------
# SECURITY & COMPLIANCE
# -----------------------------------------------------------------------------
# Purge automatique (RGPD compliance)
AUTO_PURGE_ENABLED=true
AUTO_PURGE_INTERVAL_HOURS=24
DATA_RETENTION_HOURS=24

# Encryption
ENCRYPT_FILES_AT_REST=false  # Activer en production
ENCRYPTION_KEY=  # Générer avec: openssl rand -hex 32

# Audit logging
ENABLE_AUDIT_LOG=true
AUDIT_LOG_PATH=./logs/audit.log

# -----------------------------------------------------------------------------
# DEVELOPMENT TOOLS
# -----------------------------------------------------------------------------
# Hot reload
RELOAD=true  # Uvicorn auto-reload (dev only)

# Debug SQL queries
SQL_ECHO=false  # true pour voir les requêtes SQL

# Seed data (dev)
SEED_DATABASE=false  # Populer la DB avec données de test

# Tests
TEST_DATABASE_URL=postgresql://test_user:test_password@localhost:5432/test_db
